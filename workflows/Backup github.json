{"createdAt":"2025-01-01T16:11:08.701Z","updatedAt":"2025-01-01T17:00:55.000Z","id":"fZuKhvlW8yHfspCw","name":"Backup github","active":false,"nodes":[{"parameters":{"content":"MOVE CURRENT BACKUPS TO OLD FOLDER","height":248.06218763804304,"width":982.895112064014,"color":4},"id":"5e0539ee-9d24-4cf6-a72e-c7f6ba54bf45","name":"Sticky Note","type":"n8n-nodes-base.stickyNote","position":[2306.4636782718453,344.6146058283007],"typeVersion":1},{"parameters":{"content":"PURGE BACKUPS OLDER THEN 30 DAYS\n","height":188.38611225559103,"width":980.8812626356395},"id":"8d9c70c8-7269-4640-a1ea-6eccf3c3e922","name":"Sticky Note2","type":"n8n-nodes-base.stickyNote","position":[2306.9000175440465,907.6000701761866],"typeVersion":1},{"parameters":{"mode":"jsonToBinary","options":{"fileName":"={{ $json.name }}-{{ $json.active === false ? 'inactive' : $json.active === true ? 'active' : 'unknown' }}","useRawData":true}},"name":"Move Binary Data","type":"n8n-nodes-base.moveBinaryData","position":[2580,700],"typeVersion":1,"id":"778e3f92-bf58-456b-be67-6177348d843c"},{"parameters":{"content":"## get Google Drive folders","height":755.833854865218,"width":1003.460056384994,"color":2},"id":"019a3c52-bffb-4eb9-928a-2986784a2452","name":"Sticky Note3","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[830.9644343238933,340]},{"parameters":{"content":"## Ignore any other folders other than: n8n_backups\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n    (it is important that you created this folder)","height":753.2799109651138,"width":427.1093081837156,"color":6},"id":"f098ebe5-39d5-4d2b-930c-f44f0984ced8","name":"Sticky Note4","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[1865.527396209376,340]},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"98415e9e-5354-4223-9107-ef3ade30c2f0","leftValue":"={{ $node[\"GET CURRENT FOLDER\"].json.name }}","rightValue":"n8n_backups","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"options":{}},"id":"e9716b0d-bbca-4563-9c3d-7f3dd6791221","name":"IGNORE FILES","type":"n8n-nodes-base.filter","typeVersion":2.2,"position":[2020,460]},{"parameters":{"resource":"folder","name":"n8n_backups","driveId":{"__rl":true,"mode":"list","value":"My Drive"},"folderId":{"__rl":true,"mode":"list","value":"root","cachedResultName":"/ (Root folder)"},"options":{}},"id":"097f9b0c-7829-4444-bda6-68582d354cf3","name":"Create n8n_backups","type":"n8n-nodes-base.googleDrive","typeVersion":3,"position":[1580,756.2171673095763],"credentials":{"googleDriveOAuth2Api":{"id":"Y7Yp6100s97gJGa8","name":"Google Drive Nuntius"}}},{"parameters":{"resource":"folder","name":"n8n_old","driveId":{"__rl":true,"mode":"list","value":"My Drive"},"folderId":{"__rl":true,"mode":"list","value":"root","cachedResultName":"/ (Root folder)"},"options":{}},"id":"ea27e28c-01a8-45d8-83e5-97edef860f82","name":"Create n8n_old","type":"n8n-nodes-base.googleDrive","typeVersion":3,"position":[1580,916.2171673095763],"credentials":{"googleDriveOAuth2Api":{"id":"Y7Yp6100s97gJGa8","name":"Google Drive Nuntius"}}},{"parameters":{"content":"## Contact me \n**By Mail**. [Send Mail](mailto:nuntius.creative.hub@gmail.com)","height":105.6805438265643,"width":355.73762189847923,"color":6},"id":"86fd0236-c9f4-4fbc-968b-2485c28ae221","name":"Sticky Note8","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[880,960]},{"parameters":{"content":"## Since the folder does not exist, it creates a new one.\nn8n_backups\nn8n_old","height":451.756147757587,"width":327.6965514381564,"color":5},"id":"03df58eb-218d-424f-a639-c6b7bd1bab3a","name":"Sticky Note10","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[1472.3103992657175,636.2171673095763]},{"parameters":{"resource":"fileFolder","returnAll":true,"filter":{"whatToSearch":"folders"},"options":{}},"id":"06185404-181d-4800-9a7b-315c35a0b523","name":"GET CURRENT FOLDER","type":"n8n-nodes-base.googleDrive","typeVersion":3,"position":[900,660],"alwaysOutputData":true,"notesInFlow":true,"executeOnce":true,"retryOnFail":true,"credentials":{"googleDriveOAuth2Api":{"id":"Y7Yp6100s97gJGa8","name":"Google Drive Nuntius"}},"onError":"continueRegularOutput"},{"parameters":{"jsCode":"const items = $input.all();\nconst requiredNames = [\"n8n_old\", \"n8n_backups\"];\n\n// Filtrar los nombres de la entrada\nconst folderNames = items.map(item => item.json.name);\n\n// Encontrar los nombres que faltan\nconst missingNames = requiredNames.filter(name => !folderNames.includes(name));\n\nif (missingNames.length === 0) {\n  return [{ json: { message: \"ok\" } }];\n} else {\n  return [{ json: { message: `Faltan los siguientes: ${missingNames.join(', ')}` } }];\n}\n"},"id":"f77d40b1-270b-4467-be2d-d6ddeecbf49a","name":"Code","type":"n8n-nodes-base.code","typeVersion":2,"position":[1080,660]},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"43bd468e-1018-4b45-9448-c51835ed65bc","leftValue":"={{ $json.message }}","rightValue":"n8n_old","operator":{"type":"string","operation":"contains"}}],"combinator":"and"},"options":{}},"id":"a9441f24-80ee-46fc-9b30-7205eb5a2034","name":"If n8n_old","type":"n8n-nodes-base.if","typeVersion":2.2,"position":[1260,780]},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"43bd468e-1018-4b45-9448-c51835ed65bc","leftValue":"={{ $json.message }}","rightValue":"n8n_backups","operator":{"type":"string","operation":"contains"}}],"combinator":"and"},"options":{}},"id":"1e4ca007-2f51-49c3-9a0e-c22b00053900","name":"If1 n8n_backups","type":"n8n-nodes-base.if","typeVersion":2.2,"position":[1260,540]},{"parameters":{"resource":"fileFolder","returnAll":true,"filter":{"whatToSearch":"folders"},"options":{}},"id":"be5d40b8-ba15-46cd-8383-4b76d4d107e6","name":"GET CURRENT FOLDER CREATES","type":"n8n-nodes-base.googleDrive","typeVersion":3,"position":[1680,460],"alwaysOutputData":true,"notesInFlow":true,"executeOnce":true,"retryOnFail":true,"credentials":{"googleDriveOAuth2Api":{"id":"Y7Yp6100s97gJGa8","name":"Google Drive Nuntius"}},"onError":"continueRegularOutput"},{"parameters":{"mode":"combine","combinationMode":"mergeByPosition","options":{}},"id":"c7b7fe78-23f4-48f0-abbb-1cb9eda4f35f","name":"Merge mensage","type":"n8n-nodes-base.merge","position":[1500,460],"typeVersion":2.1},{"parameters":{"resource":"fileFolder","queryString":".json","returnAll":true,"filter":{"folderId":{"__rl":true,"value":"1ZwT37QsrdxpdP0yp9yJLka-TSIIuxruu","mode":"list","cachedResultName":"n8n_backups","cachedResultUrl":"https://drive.google.com/drive/folders/1ZwT37QsrdxpdP0yp9yJLka-TSIIuxruu"}},"options":{"fields":["name","id"]}},"id":"5a98a2af-9c70-4112-a6aa-bba0824e0722","name":"GET CURRENT BACKUPS1","type":"n8n-nodes-base.googleDrive","typeVersion":3,"position":[2380,420],"credentials":{"googleDriveOAuth2Api":{"id":"Y7Yp6100s97gJGa8","name":"Google Drive Nuntius"}}},{"parameters":{"rule":{"interval":[{}]}},"id":"6e12b398-9990-4ba8-8962-3f15fd2cd653","name":"Schedule Trigger","type":"n8n-nodes-base.scheduleTrigger","position":[900,460],"typeVersion":1.1},{"parameters":{"content":"## Does a folder exist?, if it does not exist it creates it","height":542.95115693689,"width":203.08765089203305,"color":7},"id":"43465509-853b-46b9-a6c6-a9a0211c50d7","name":"Sticky Note5","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[1216.912349107967,380]},{"parameters":{"operation":"move","fileId":{"__rl":true,"value":"={{ $json.id }}","mode":"id"},"driveId":{"__rl":true,"value":"My Drive","mode":"list","cachedResultName":"My Drive","cachedResultUrl":"https://drive.google.com/drive/my-drive"},"folderId":{"__rl":true,"value":"1UcusrWKnbFl3cJYIjaDdp1VCgreg2oeV","mode":"list","cachedResultName":"n8n_old","cachedResultUrl":"https://drive.google.com/drive/folders/1UcusrWKnbFl3cJYIjaDdp1VCgreg2oeV"}},"id":"1d8785f1-24e6-4067-911f-0b780cb5e26c","name":"MOVE INTO OLD FOLDER","type":"n8n-nodes-base.googleDrive","typeVersion":3,"position":[3060,400],"alwaysOutputData":true,"credentials":{"googleDriveOAuth2Api":{"id":"Y7Yp6100s97gJGa8","name":"Google Drive Nuntius"}},"onError":"continueRegularOutput"},{"parameters":{"rule":{"interval":[{"daysInterval":30}]}},"id":"a5b2a636-0b2f-4ef0-a0ee-556b27b0f234","name":"Schedule Trigger1","type":"n8n-nodes-base.scheduleTrigger","position":[2340,940],"typeVersion":1.1},{"parameters":{"authentication":"oAuth2","binaryData":true,"name":"={{ $('Split In Batches').item.binary.data.fileName }}-{{ $node[\"n8n\"].json[\"updatedAt\"] }}.json\n\n","parents":["={{ $('IGNORE FILES').item.json.id }}"],"options":{}},"name":"UPLOAD WORKFLOWS","type":"n8n-nodes-base.googleDrive","position":[3060,680],"typeVersion":1,"id":"12095141-5b8f-43c4-861e-aea9e4a6feef","credentials":{"googleDriveOAuth2Api":{"id":"Y7Yp6100s97gJGa8","name":"Google Drive Nuntius"}}},{"parameters":{"content":"## Description\nThis template creates a nightly backup of all n8n workflows and saves them to a Google Drive folder. Each night, the previous night's backups are moved to an “n8n_old” folder and renamed with the corresponding date.\n\nBackups older than a specified age are automatically deleted (this feature is active for 30 days, you can remove it if you don't want the backups to be deleted).\n\n## Prerequisites\n\n- Google Drive account and credentials **Get** from the following link. [Link](https://console.cloud.google.com/apis/credentials/oauthclient/)\n- n8n version 1.63.4 or higher\n- N8n api key **Guide** from the following link. [Link](https://witmovil.com/where-to-create-the-api-key-in-n8n/)\n- A destination folder for backups:\n“n8n_old”\n“n8n_backups”\n(if it doesn't exist, create it)\n\n## Configuration\nUpdate all Google Drive nodes with your credentials.\nEdit the Schedule Trigger node with the desired time to run the backup.\nIf you want to automatically purge old backups.\n\nEdit the “PURGE DAYS” node to specify the age of the backups you want to delete.\nEnable the “PURGE DAYS” node and the 3 subsequent nodes.\nEnable the workflow to run on the specified schedule.","height":759.2757638563562,"width":397.07512898799075,"color":3},"id":"e64b110f-bae1-4a7e-9b63-1cb90bb3987c","name":"Sticky Note6","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[400,340]},{"parameters":{"fieldToSplitOut":"id","options":{}},"id":"5332daa2-e6be-4115-ac08-38d4550fdff7","name":"Item Lists","type":"n8n-nodes-base.itemLists","typeVersion":3,"position":[2580,420]},{"parameters":{"batchSize":1,"options":{"reset":false}},"id":"64caabff-afd0-4d8c-b274-1d6783a45bb6","name":"Split In Batches2","type":"n8n-nodes-base.splitInBatches","typeVersion":2,"position":[2800,420]},{"parameters":{"batchSize":1,"options":{"reset":false}},"id":"9f9b53ec-1477-4438-9f06-5714fe7c78e1","name":"Split In Batches","type":"n8n-nodes-base.splitInBatches","typeVersion":2,"position":[2800,700]},{"parameters":{"returnAll":false,"filters":{},"requestOptions":{}},"id":"2bc5e18a-175b-4a01-89cd-5cb37925fe2f","name":"n8n","type":"n8n-nodes-base.n8n","typeVersion":1,"position":[2380,700],"credentials":{"n8nApi":{"id":"cYbTgH3gULzTLxED","name":"n8n account"}}},{"parameters":{"resource":"fileFolder","queryString":".json","returnAll":true,"filter":{"folderId":{"__rl":true,"value":"1UcusrWKnbFl3cJYIjaDdp1VCgreg2oeV","mode":"list","cachedResultName":"n8n_old","cachedResultUrl":"https://drive.google.com/drive/folders/1UcusrWKnbFl3cJYIjaDdp1VCgreg2oeV"}},"options":{"fields":["name","id"]}},"id":"fbb4d8be-1dd7-45fd-a6a1-e324da3d504a","name":"LIST OLD BACKUPS","type":"n8n-nodes-base.googleDrive","typeVersion":3,"position":[2540,940],"credentials":{"googleDriveOAuth2Api":{"id":"Y7Yp6100s97gJGa8","name":"Google Drive Nuntius"}}},{"parameters":{"operation":"deleteFile","fileId":{"__rl":true,"value":"={{ $json.id }}","mode":"id"},"options":{"deletePermanently":true}},"id":"1ef0a282-222b-4599-bb9b-9d7661056295","name":"DELETE OLD BACKUP","type":"n8n-nodes-base.googleDrive","typeVersion":3,"position":[3140,920],"alwaysOutputData":true,"credentials":{"googleDriveOAuth2Api":{"id":"Y7Yp6100s97gJGa8","name":"Google Drive Nuntius"}},"onError":"continueRegularOutput"},{"parameters":{"fieldToSplitOut":"id","options":{}},"id":"0c463d97-5db8-4eac-901c-6b9cabc0ff9c","name":"Item Lists old","type":"n8n-nodes-base.itemLists","typeVersion":3,"position":[2740,940]},{"parameters":{"batchSize":1,"options":{"reset":false}},"id":"2231e69b-f0d1-4c86-b5ef-06a3882e5921","name":"Split In Batches old","type":"n8n-nodes-base.splitInBatches","typeVersion":2,"position":[2940,940]},{"parameters":{"content":"## Bug fixes: \n* Now it scans through each file to save, move or delete.\n* Added active/inactive tag to name to know how it is.\n* Fixed names and filters.\nSet limit to 100, but can be changed to n8n for more copies.\n* Now they save one by one so that the saving is more accurate.","height":232.84367238845454,"width":344.2988945561964,"color":3},"id":"e8f80c9f-ee88-4408-9859-b169ce160d6e","name":"Sticky Note9","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[1900,800]},{"parameters":{"content":"BACKUP ALL CURRENT WORKFLOWS limit 100 (Change)","height":267.23574473121596,"width":984.8018228465335,"color":5},"id":"cd25a236-34e5-4108-ba93-ccad514e16bc","name":"Sticky Note1","type":"n8n-nodes-base.stickyNote","position":[2307.7625197370526,621.8118426547078],"typeVersion":1},{"parameters":{"authentication":"oAuth2","resource":"file","owner":{"__rl":true,"mode":"list","value":""},"repository":{"__rl":true,"mode":"list","value":""}},"id":"175d5272-23ed-4bed-a039-22602148fc49","name":"GitHub","type":"n8n-nodes-base.github","typeVersion":1,"position":[2540,1360],"credentials":{"githubOAuth2Api":{"id":"NLzdDMnYujLOPhDV","name":"GitHub account"}}},{"parameters":{"authentication":"oAuth2","resource":"repository","owner":{"__rl":true,"mode":"list","value":""},"repository":{"__rl":true,"mode":"list","value":""},"returnAll":true,"getRepositoryIssuesFilters":{}},"id":"0688fe5b-3926-4785-96cf-a58fa75c9b78","name":"GitHub1","type":"n8n-nodes-base.github","typeVersion":1,"position":[1780,1420],"credentials":{"githubOAuth2Api":{"id":"NLzdDMnYujLOPhDV","name":"GitHub account"}}},{"parameters":{},"id":"c8a47d8c-8c81-4e58-a14b-980572c1054e","name":"When clicking ‘Test workflow’","type":"n8n-nodes-base.manualTrigger","typeVersion":1,"position":[1460,1420]}],"connections":{"Move Binary Data":{"main":[[{"node":"Split In Batches","type":"main","index":0}]]},"IGNORE FILES":{"main":[[{"node":"GET CURRENT BACKUPS1","type":"main","index":0},{"node":"n8n","type":"main","index":0}]]},"Create n8n_backups":{"main":[[{"node":"GET CURRENT FOLDER","type":"main","index":0}]]},"Create n8n_old":{"main":[[{"node":"GET CURRENT FOLDER","type":"main","index":0}]]},"GET CURRENT FOLDER":{"main":[[{"node":"Code","type":"main","index":0}]]},"Code":{"main":[[{"node":"If n8n_old","type":"main","index":0},{"node":"If1 n8n_backups","type":"main","index":0}]]},"If n8n_old":{"main":[[{"node":"Create n8n_old","type":"main","index":0}],[{"node":"Merge mensage","type":"main","index":1}]]},"If1 n8n_backups":{"main":[[{"node":"Create n8n_backups","type":"main","index":0}],[{"node":"Merge mensage","type":"main","index":0}]]},"GET CURRENT FOLDER CREATES":{"main":[[{"node":"IGNORE FILES","type":"main","index":0}]]},"Merge mensage":{"main":[[{"node":"GET CURRENT FOLDER CREATES","type":"main","index":0}]]},"GET CURRENT BACKUPS1":{"main":[[{"node":"Item Lists","type":"main","index":0}]]},"Item Lists":{"main":[[{"node":"Split In Batches2","type":"main","index":0}]]},"Split In Batches2":{"main":[[{"node":"MOVE INTO OLD FOLDER","type":"main","index":0}]]},"MOVE INTO OLD FOLDER":{"main":[[{"node":"Split In Batches2","type":"main","index":0}]]},"Split In Batches":{"main":[[{"node":"UPLOAD WORKFLOWS","type":"main","index":0}]]},"UPLOAD WORKFLOWS":{"main":[[{"node":"Split In Batches","type":"main","index":0}]]},"n8n":{"main":[[{"node":"Move Binary Data","type":"main","index":0}]]},"Schedule Trigger1":{"main":[[]]},"LIST OLD BACKUPS":{"main":[[{"node":"Item Lists old","type":"main","index":0}]]},"Schedule Trigger":{"main":[[]]},"DELETE OLD BACKUP":{"main":[[{"node":"Split In Batches old","type":"main","index":0}]]},"Item Lists old":{"main":[[{"node":"Split In Batches old","type":"main","index":0}]]},"Split In Batches old":{"main":[[{"node":"DELETE OLD BACKUP","type":"main","index":0}]]},"GitHub":{"main":[[]]},"When clicking ‘Test workflow’":{"main":[[{"node":"GitHub1","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":{"node:Schedule Trigger":{"recurrenceRules":[]},"node:Schedule Trigger1":{"recurrenceRules":[354]}},"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"0398e90f-07af-43f6-96fa-bf3d100c4e0f","triggerCount":2,"tags":[]}